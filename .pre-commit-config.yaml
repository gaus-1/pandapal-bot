# ============================================================================
# PRE-COMMIT HOOKS –î–õ–Ø PANDAPAL BOT
# ============================================================================
# –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Senior/Lead —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
# –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –∫–∞—á–µ—Å—Ç–≤–æ–º –∫–æ–¥–∞ –∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∫–æ–º–∞–Ω–¥—ã
# ============================================================================

repos:
  # ============================================================================
  # –ë–ê–ó–û–í–´–ï –ü–†–û–í–ï–†–ö–ò (–ë–´–°–¢–†–´–ï –ò –í–ê–ñ–ù–´–ï)
  # ============================================================================
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v5.0.0
    hooks:
      - id: trailing-whitespace
        name: üßπ –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–±–µ–ª–æ–≤ –≤ –∫–æ–Ω—Ü–µ —Å—Ç—Ä–æ–∫
      - id: end-of-file-fixer
        name: üìÑ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ü–∞ —Ñ–∞–π–ª–æ–≤
      - id: check-yaml
        name: ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ YAML —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
        exclude: ^(frontend/.*\.yml$|\.github/workflows/.*\.yml$)
      - id: check-added-large-files
        name: üì¶ –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ (>1MB)
        args: ['--maxkb=1000']
      - id: check-merge-conflict
        name: ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ä–∫–µ—Ä–æ–≤ —Å–ª–∏—è–Ω–∏—è
      - id: check-json
        name: ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ JSON —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
        exclude: ^(frontend/.*\.json$|.*tsconfig.*\.json$)
      - id: mixed-line-ending
        name: üìù –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫–æ–Ω—á–∞–Ω–∏–π —Å—Ç—Ä–æ–∫
      - id: forbid-new-submodules
        name: üö´ –ó–∞–ø—Ä–µ—Ç –Ω–æ–≤—ã—Ö submodules

  # ============================================================================
  # –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û (–ë–õ–û–ö–ò–†–£–Æ–©–ò–ô)
  # ============================================================================
  - repo: https://github.com/Yelp/detect-secrets
    rev: v1.5.0
    hooks:
      - id: detect-secrets
        name: üõ°Ô∏è detect-secrets - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤
        args: ['--baseline', '.secrets.baseline']
        exclude: ^(tests/|scripts/|\.env|\.git/)

  # ============================================================================
  # –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–ï PYTHON (–ê–í–¢–û–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï)
  # ============================================================================
  - repo: https://github.com/psf/black
    rev: 25.9.0
    hooks:
      - id: black
        name: üé® Black - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
        language_version: python3.13
        args: ['--line-length=100']

  - repo: https://github.com/pycqa/isort
    rev: 6.1.0
    hooks:
      - id: isort
        name: üìö isort - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤
        args: ['--profile', 'black', '--line-length', '100']

  # ============================================================================
  # –õ–ò–ù–¢–ò–ù–ì PYTHON (–¢–û–õ–¨–ö–û –ö–†–ò–¢–ò–ß–ù–´–ï –û–®–ò–ë–ö–ò)
  # ============================================================================
  - repo: https://github.com/pycqa/flake8
    rev: 7.3.0
    hooks:
      - id: flake8
        name: üîç flake8 - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∏–ª—è
        args:
          - '--max-line-length=100'
          - '--extend-ignore=E203,W503,D205,D400,D200,F841,C901,E501'
          - '--max-complexity=15'
        additional_dependencies: [flake8-docstrings]
        exclude: ^(tests/|scripts/|alembic/)

  # ============================================================================
  # RUFF - –ë–´–°–¢–†–´–ô –õ–ò–ù–¢–ï–† (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û, –ü–ê–†–ê–õ–õ–ï–õ–¨–ù–û –° FLAKE8)
  # ruff-format –æ—Ç–∫–ª—é—á–µ–Ω, —Ç.–∫. –∏—Å–ø–æ–ª—å–∑—É–µ–º black –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
  # ============================================================================
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.8.4
    hooks:
      - id: ruff
        name: ‚ö° ruff - –±—ã—Å—Ç—Ä—ã–π –ª–∏–Ω—Ç–µ—Ä
        args: ['--fix', '--exit-non-zero-on-fix']
        exclude: ^(tests/|scripts/|alembic/)

  # ============================================================================
  # MYPY - –¢–û–õ–¨–ö–û –î–õ–Ø –ù–û–í–´–• –§–ê–ô–õ–û–í (–ù–ï –ë–õ–û–ö–ò–†–£–ï–¢ –ö–û–ú–ú–ò–¢–´)
  # ============================================================================
  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.18.2
    hooks:
      - id: mypy
        name: üî¨ mypy - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ (soft)
        additional_dependencies:
          - types-requests
          - types-setuptools
          - types-aiofiles
        args:
          - '--ignore-missing-imports'
          - '--no-strict-optional'
          - '--show-error-codes'
          - '--warn-unused-ignores'
          - '--no-error-summary'
        exclude: ^(tests/|scripts/|alembic/|bot/services/|bot/handlers/)
        # –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∫–æ–º–º–∏—Ç, —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç
        verbose: true
        stages: [manual]  # –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑: git commit --no-verify

  # ============================================================================
  # PYLINT - –¢–û–õ–¨–ö–û –î–õ–Ø –ù–û–í–´–• –§–ê–ô–õ–û–í (–ù–ï –ë–õ–û–ö–ò–†–£–ï–¢)
  # ============================================================================
  - repo: https://github.com/pycqa/pylint
    rev: v4.0.2
    hooks:
      - id: pylint
        name: üîé pylint - –≥–ª—É–±–æ–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (soft)
        args:
          - '--max-line-length=100'
          - '--disable=C0114,C0115,C0116,R0903,R0913,E0401,W0611,E0013,R0801,C0301'
          - '--fail-under=7.0'
        exclude: ^(tests/|scripts/|alembic/|bot/config\.py|bot/services/|bot/handlers/)
        # –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∫–æ–º–º–∏—Ç
        stages: [manual]  # –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤—Ä—É—á–Ω—É—é

  # ============================================================================
  # –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ - –¢–û–õ–¨–ö–û –î–õ–Ø MANUAL –ü–†–û–í–ï–†–ö–ò
  # ============================================================================
  - repo: https://github.com/PyCQA/bandit
    rev: 1.7.10
    hooks:
      - id: bandit
        name: üõ°Ô∏è bandit - –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        args: ['-r', 'bot/', '-ll', '--skip', 'B101,B601,B104', '-f', 'text']
        exclude: ^(tests/|scripts/)
        pass_filenames: false
        verbose: true
        stages: [manual]  # –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤—Ä—É—á–Ω—É—é: pre-commit run bandit --all-files

  # ============================================================================
  # –ü–†–û–í–ï–†–ö–ê –£–Ø–ó–í–ò–ú–û–°–¢–ï–ô –ó–ê–í–ò–°–ò–ú–û–°–¢–ï–ô
  # ============================================================================
  # –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º hook'–∞
  # –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: safety check –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤—Ä—É—á–Ω—É—é
  # - repo: https://github.com/Lucas-C/pre-commit-hooks-safety
  #   rev: v1.3.3
  #   hooks:
  #     - id: python-safety-dependencies
  #       name: üîí safety - –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π Python
  #       args: ['--continue-on-failure']
  #       stages: [manual]  # –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é: pre-commit run python-safety-dependencies --all-files

  # ============================================================================
  # –§–†–û–ù–¢–ï–ù–î - ESLINT –ò PRETTIER
  # ============================================================================
  - repo: https://github.com/pre-commit/mirrors-prettier
    rev: v3.1.0
    hooks:
      - id: prettier
        name: üíÖ Prettier - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
        types: [file]
        files: ^frontend/.*\.(ts|tsx|js|jsx|css|json|md)$
        exclude: ^(frontend/node_modules/|frontend/dist/|frontend/package-lock\.json)

  - repo: local
    hooks:
      - id: eslint
        name: üîç ESLint - –ø—Ä–æ–≤–µ—Ä–∫–∞ TypeScript/JavaScript
        entry: bash -c 'cd frontend && npm run lint'
        language: system
        types: [file]
        files: ^frontend/src/.*\.(ts|tsx|js|jsx)$
        pass_filenames: false
        always_run: false

      - id: npm-audit
        name: üîí npm audit - –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π Node.js
        entry: bash -c 'cd frontend && npm audit --audit-level=moderate'
        language: system
        pass_filenames: false
        always_run: false
        stages: [manual]  # –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é: pre-commit run npm-audit --all-files

      - id: pip-audit
        name: üîí pip-audit - –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π Python
        entry: bash -c 'pip-audit --desc --format json || true'
        language: system
        pass_filenames: false
        always_run: false
        stages: [manual]  # –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é: pre-commit run pip-audit --all-files

# ============================================================================
# –ò–ù–°–¢–†–£–ö–¶–ò–ò –ü–û –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ
# ============================================================================
#
# –ü–ï–†–í–´–ô –ó–ê–ü–£–°–ö (–ù–ê–°–¢–†–û–ô–ö–ê detect-secrets):
#   detect-secrets scan > .secrets.baseline
#   git add .secrets.baseline
#
# –û–ë–´–ß–ù–´–ô –ö–û–ú–ú–ò–¢:
#   git commit -m "feat: –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è"
#   ‚Üí –ó–∞–ø—É—Å—Ç—è—Ç—Å—è: detect-secrets, trailing-whitespace, black, isort,
#      ruff, flake8, prettier, eslint
#
# –ë–´–°–¢–†–´–ô –ö–û–ú–ú–ò–¢ (–ë–ï–ó –ü–†–û–í–ï–†–û–ö):
#   git commit --no-verify -m "fix: –±—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"
#
# –ü–û–õ–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –í–†–£–ß–ù–£–Æ:
#   pre-commit run --all-files
#
# –ü–†–û–í–ï–†–ö–ê –¢–ò–ü–û–í –í–†–£–ß–ù–£–Æ:
#   pre-commit run mypy --all-files
#
# –ü–†–û–í–ï–†–ö–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò –í–†–£–ß–ù–£–Æ:
#   pre-commit run bandit --all-files
#
# –ü–†–û–í–ï–†–ö–ê –£–Ø–ó–í–ò–ú–û–°–¢–ï–ô –ó–ê–í–ò–°–ò–ú–û–°–¢–ï–ô:
#   pre-commit run pip-audit --all-files
#   pre-commit run npm-audit --all-files
#
# ============================================================================
