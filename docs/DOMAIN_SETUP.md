# üåê –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –î–û–ú–ï–ù–ê PANDAPAL.RU –ö RAILWAY

## ‚úÖ **–ß–¢–û –£ –ù–ê–° –ï–°–¢–¨:**
1. ‚úÖ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç reg.ru (–∞–∫—Ç–∏–≤–µ–Ω –¥–æ 01.05.2026)
2. ‚úÖ –î–æ–º–µ–Ω pandapal.ru –Ω–∞ reg.ru
3. ‚úÖ –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Railway: `pandapal-bot-production.up.railway.app`
4. ‚úÖ Frontend –Ω–∞ Railway (–∏–ª–∏ –º–æ–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ)

---

## üéØ **–¶–ï–õ–¨:**
–°–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã:
- `https://pandapal.ru` ‚Üí Frontend (React —Å–∞–π—Ç)
- `https://api.pandapal.ru` ‚Üí Backend API + Telegram Webhook
- SSL —Ä–∞–±–æ—Ç–∞–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –í—Å—ë –±—ã–ª–æ –±—ã—Å—Ç—Ä–æ –∏ –Ω–∞–¥—ë–∂–Ω–æ

---

## üöÄ **–†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ô –°–ü–û–°–û–ë: CLOUDFLARE (–ë–ï–°–ü–õ–ê–¢–ù–û + –ë–´–°–¢–†–û)**

### **–ü–æ—á–µ–º—É Cloudflare:**
- ‚úÖ **–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π SSL** (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- ‚úÖ **CDN** (—É—Å–∫–æ—Ä–µ–Ω–∏–µ —Å–∞–π—Ç–∞ –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É)
- ‚úÖ **DDoS –∑–∞—â–∏—Ç–∞** (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
- ‚úÖ **–ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** (5 –º–∏–Ω—É—Ç)
- ‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç —Å Railway** (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ)

---

## üìã **–ü–û–®–ê–ì–û–í–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø:**

### **1Ô∏è‚É£ –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –í CLOUDFLARE**

1. –ó–∞–π–¥–∏ –Ω–∞ https://dash.cloudflare.com/sign-up
2. –°–æ–∑–¥–∞–π –∞–∫–∫–∞—É–Ω—Ç (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω FREE)
3. –î–æ–±–∞–≤—å –¥–æ–º–µ–Ω `pandapal.ru`
4. Cloudflare –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä—É–µ—Ç DNS –∑–∞–ø–∏—Å–∏

---

### **2Ô∏è‚É£ –ó–ê–ú–ï–ù–ê NAMESERVERS –ù–ê REG.RU**

Cloudflare –ø–æ–∫–∞–∂–µ—Ç 2 nameserver:
```
bart.ns.cloudflare.com
joan.ns.cloudflare.com
```

**–ù–∞ reg.ru:**
1. –ü–µ—Ä–µ–π–¥–∏ –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–º–µ–Ω–æ–º `pandapal.ru`
2. –ù–∞–π–¥–∏ —Ä–∞–∑–¥–µ–ª **"NS-—Å–µ—Ä–≤–µ—Ä—ã"** –∏–ª–∏ **"DNS"**
3. –£–¥–∞–ª–∏ —Å—Ç–∞—Ä—ã–µ NS-—Å–µ—Ä–≤–µ—Ä—ã reg.ru
4. –î–æ–±–∞–≤—å 2 nameserver –æ—Ç Cloudflare:
   ```
   bart.ns.cloudflare.com
   joan.ns.cloudflare.com
   ```
5. –°–æ—Ö—Ä–∞–Ω–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è

‚è±Ô∏è **–û–∂–∏–¥–∞–Ω–∏–µ:** 10 –º–∏–Ω—É—Ç - 24 —á–∞—Å–∞ (–æ–±—ã—á–Ω–æ 1-2 —á–∞—Å–∞)

---

### **3Ô∏è‚É£ –ù–ê–°–¢–†–û–ô–ö–ê DNS –ó–ê–ü–ò–°–ï–ô –í CLOUDFLARE**

–ü–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –¥–æ–º–µ–Ω–∞ –≤ Cloudflare, –¥–æ–±–∞–≤—å DNS –∑–∞–ø–∏—Å–∏:

#### **A. Frontend (–≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞):**
```
Type: CNAME
Name: @
Target: pandapal-bot-production.up.railway.app
Proxy: ‚úÖ Proxied (–æ—Ä–∞–Ω–∂–µ–≤–æ–µ –æ–±–ª–∞–∫–æ)
```

#### **B. API/Backend (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
```
Type: CNAME
Name: api
Target: pandapal-bot-production.up.railway.app
Proxy: ‚úÖ Proxied (–æ—Ä–∞–Ω–∂–µ–≤–æ–µ –æ–±–ª–∞–∫–æ)
```

#### **C. WWW (—Ä–µ–¥–∏—Ä–µ–∫—Ç):**
```
Type: CNAME
Name: www
Target: pandapal.ru
Proxy: ‚úÖ Proxied
```

---

### **4Ô∏è‚É£ –ù–ê–°–¢–†–û–ô–ö–ê SSL –í CLOUDFLARE**

1. –ü–µ—Ä–µ–π–¥–∏ –≤ **SSL/TLS** ‚Üí **Overview**
2. –í—ã–±–µ—Ä–∏ —Ä–µ–∂–∏–º: **Full (strict)** ‚úÖ
3. Cloudflare –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–¥–∞—Å—Ç –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π SSL

---

### **5Ô∏è‚É£ –ù–ê–°–¢–†–û–ô–ö–ê RAILWAY**

**–í Railway Dashboard:**

1. –û—Ç–∫—Ä–æ–π –ø—Ä–æ–µ–∫—Ç `pandapal-bot-production`
2. –ü–µ—Ä–µ–π–¥–∏ –≤ **Settings** ‚Üí **Networking**
3. –ù–∞–∂–º–∏ **Custom Domain**
4. –î–æ–±–∞–≤—å –¥–æ–º–µ–Ω—ã:
   ```
   pandapal.ru
   www.pandapal.ru
   api.pandapal.ru
   ```
5. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–¥–∞—Å—Ç SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç

---

### **6Ô∏è‚É£ –û–ë–ù–û–í–õ–ï–ù–ò–ï –ü–ï–†–ï–ú–ï–ù–ù–´–• –û–ö–†–£–ñ–ï–ù–ò–Ø**

**–í Railway ‚Üí Variables:**

```env
WEBHOOK_DOMAIN=api.pandapal.ru
FRONTEND_URL=https://pandapal.ru
```

**–ò–ª–∏ –µ—Å–ª–∏ –≤—Å—ë –Ω–∞ –æ–¥–Ω–æ–º –¥–æ–º–µ–Ω–µ:**
```env
WEBHOOK_DOMAIN=pandapal.ru
FRONTEND_URL=https://pandapal.ru
```

---

### **7Ô∏è‚É£ –û–ë–ù–û–í–õ–ï–ù–ò–ï –ö–û–î–ê (bot/config.py)**

```python
webhook_domain: str = Field(
    default="pandapal.ru",  # ‚Üê –ò–ó–ú–ï–ù–ò–¢–¨
    description="–î–æ–º–µ–Ω –¥–ª—è webhook (–±–µ–∑ https://)",
    validation_alias=AliasChoices("WEBHOOK_DOMAIN", "webhook_domain"),
)
```

---

### **8Ô∏è‚É£ –ü–†–û–í–ï–†–ö–ê –†–ê–ë–û–¢–û–°–ü–û–°–û–ë–ù–û–°–¢–ò**

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—á–µ—Ä–µ–∑ 10-30 –º–∏–Ω—É—Ç):

1. **–ü—Ä–æ–≤–µ—Ä—å DNS:**
   ```bash
   nslookup pandapal.ru
   # –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å IP Cloudflare
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å SSL:**
   - –û—Ç–∫—Ä–æ–π https://pandapal.ru –≤ –±—Ä–∞—É–∑–µ—Ä–µ
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–µ–ª—ë–Ω—ã–π –∑–∞–º–æ—á–µ–∫ üîí

3. **–ü—Ä–æ–≤–µ—Ä—å webhook:**
   ```bash
   curl https://pandapal.ru/health
   # –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: {"status": "ok"}
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å –±–æ—Ç–∞:**
   - –ù–∞–ø–∏—à–∏ `/start` –≤ Telegram
   - –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å

---

## üé® **–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò CLOUDFLARE (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û)**

### **A. –°–∫–æ—Ä–æ—Å—Ç—å:**
1. **Speed** ‚Üí **Optimization**
2. –í–∫–ª—é—á–∏:
   - ‚úÖ Auto Minify (HTML, CSS, JS)
   - ‚úÖ Brotli
   - ‚úÖ Early Hints

### **B. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
1. **Security** ‚Üí **Settings**
2. –í–∫–ª—é—á–∏:
   - ‚úÖ Security Level: Medium
   - ‚úÖ Bot Fight Mode
   - ‚úÖ Challenge Passage: 30 minutes

### **C. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**
1. **Caching** ‚Üí **Configuration**
2. –ö–µ—à Level: Standard

---

## ‚ö†Ô∏è **–í–û–ó–ú–û–ñ–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:**

### **1. "Too many redirects"**
**–†–µ—à–µ–Ω–∏–µ:**
- –í Cloudflare ‚Üí SSL/TLS –≤—ã–±–µ—Ä–∏ **Full (strict)**
- –í Railway —É–±–µ–¥–∏—Å—å —á—Ç–æ SSL –≤–∫–ª—é—á–µ–Ω

### **2. "502 Bad Gateway"**
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ Railway –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ
- –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Railway: `railway logs`

### **3. "Webhook failed"**
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å `WEBHOOK_DOMAIN` –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –£–±–µ–¥–∏—Å—å —á—Ç–æ –¥–æ–º–µ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω: `curl https://pandapal.ru/webhook`

### **4. "SSL certificate error"**
**–†–µ—à–µ–Ω–∏–µ:**
- –ü–æ–¥–æ–∂–¥–∏ 10-30 –º–∏–Ω—É—Ç (Let's Encrypt –≤—ã–¥–∞–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç)
- Cloudflare –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–∏—Ç

---

## üéØ **–ò–¢–û–ì–û–í–ê–Ø –°–¢–†–£–ö–¢–£–†–ê:**

```
pandapal.ru (Cloudflare CDN)
    ‚Üì
    ‚îú‚îÄ‚îÄ Frontend (React) ‚Üí Railway
    ‚îú‚îÄ‚îÄ Backend API ‚Üí Railway
    ‚îî‚îÄ‚îÄ Telegram Webhook ‚Üí Railway

Railway PostgreSQL ‚Üê Backend
```

---

## üí∞ **–°–¢–û–ò–ú–û–°–¢–¨:**

| –°–µ—Ä–≤–∏—Å | –°—Ç–æ–∏–º–æ—Å—Ç—å |
|--------|-----------|
| **Cloudflare** | $0/–º–µ—Å (FREE –ø–ª–∞–Ω) |
| **Railway** | ~$5/–º–µ—Å (PostgreSQL + Bot) |
| **reg.ru** | –£–∂–µ –æ–ø–ª–∞—á–µ–Ω (–¥–æ–º–µ–Ω + SSL) |
| **–ò–¢–û–ì–û** | **~$5/–º–µ—Å** |

---

## üöÄ **–ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ê: –ë–ï–ó CLOUDFLARE**

–ï—Å–ª–∏ –ù–ï —Ö–æ—á–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Cloudflare:

### **–ù–∞ reg.ru –Ω–∞—Å—Ç—Ä–æ–π A-–∑–∞–ø–∏—Å—å:**
```
Type: A
Name: @
Value: [IP Railway] ‚Üê –ù—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å —É Railway
```

**–ù–û:**
- ‚ùå –ù–µ—Ç CDN (–º–µ–¥–ª–µ–Ω–Ω–µ–µ)
- ‚ùå –ù–µ—Ç DDoS –∑–∞—â–∏—Ç—ã
- ‚úÖ SSL –æ—Ç reg.ru –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

---

## ‚úÖ **–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:**

**–ò—Å–ø–æ–ª—å–∑—É–π Cloudflare!** –≠—Ç–æ:
- üöÄ –ë—ã—Å—Ç—Ä–µ–µ
- üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–µ–µ
- üí∞ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ
- üîß –ü—Ä–æ—â–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å

---

## üìû **–ù–£–ñ–ù–ê –ü–û–ú–û–©–¨?**

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è:
1. –ü–æ–∫–∞–∂–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç –æ—à–∏–±–∫–∏
2. –°–∫–æ–ø–∏—Ä—É–π –ª–æ–≥–∏ Railway
3. –ü—Ä–æ–≤–µ—Ä—å DNS —á–µ—Ä–µ–∑ https://dns-checker.org

**–Ø –ø–æ–º–æ–≥—É –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ!** üêº
