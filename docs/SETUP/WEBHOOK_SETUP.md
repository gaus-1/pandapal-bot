# üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Webhook –¥–ª—è PandaPal –Ω–∞ Render.com

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–∞ Render.com

### **Environment Variables (–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è)**

–ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://render.com ‚Üí –≤–∞—à —Å–µ—Ä–≤–∏—Å ‚Üí **Environment**

–î–æ–±–∞–≤—å—Ç–µ —ç—Ç—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:

```
WEBHOOK_DOMAIN=pandapal-bot.onrender.com
```

### **–ì–æ—Ç–æ–≤–æ!**

–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã:
- ‚úÖ `TELEGRAM_BOT_TOKEN`
- ‚úÖ `GEMINI_API_KEY`
- ‚úÖ `DATABASE_URL`
- ‚úÖ `GEMINI_MODEL`
- ‚úÖ `PORT` (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç Render)

---

## üéØ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### **Webhook —Ä–µ–∂–∏–º:**

1. **Render –∑–∞–ø—É—Å–∫–∞–µ—Ç** `web_server.py`
2. **web_server.py –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç** `webhook_bot.py`
3. **webhook_bot.py —Å–æ–∑–¥–∞–µ—Ç** aiohttp –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å endpoint `/webhook`
4. **Telegram –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç** –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ `https://pandapal-bot.onrender.com/webhook`
5. **–ë–æ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç** —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –æ—Ç–≤–µ—á–∞–µ—Ç

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Webhook

- ‚úÖ **–ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏
- ‚úÖ **–ù–∏–∑–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞** - Telegram —Å–∞–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å 24/7** - –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥

---

## üîß –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Polling —Ä–µ–∂–∏–º**:

```bash
python main.py
```

Polling —É–¥–æ–±–Ω–µ–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –∞ Webhook - –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞.

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **Health check:** https://pandapal-bot.onrender.com/health
2. **Webhook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:** –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "Webhook URL: https://pandapal-bot.onrender.com/webhook"
3. **–ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç:** –ù–∞–ø–∏—à–∏—Ç–µ –±–æ—Ç—É –≤ Telegram

---

## üêõ Troubleshooting

### –ï—Å–ª–∏ –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ Render: –µ—Å—Ç—å –ª–∏ "Webhook URL"?
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `WEBHOOK_DOMAIN` –Ω–∞ Render
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `PORT=10000` (–∏–ª–∏ Render —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

### –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ "Webhook already set":

–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ. –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç webhook.

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

Endpoints –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
- `/health` - –ø—Ä–æ—Å—Ç–æ–π health check
- `/` - —Ç–æ –∂–µ —Å–∞–º–æ–µ

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "status": "ok",
  "mode": "webhook",
  "webhook_url": "https://pandapal-bot.onrender.com/webhook"
}
```

---

## ‚ú® –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è `WEBHOOK_DOMAIN` –Ω–∞ Render:
1. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
2. Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç
3. –ë–æ—Ç –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ 2-3 –º–∏–Ω—É—Ç—ã
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ Telegram

**–ë–æ—Ç –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ 24/7!** üéâ
