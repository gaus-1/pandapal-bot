---
alwaysApply: false
---

# üîí –ó–∞—â–∏—Ç–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–¥–∞ PandaPal

## Production-–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥—É–ª–∏

–≠—Ç–∏ –º–æ–¥—É–ª–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞ 24/7. –ò–∑–º–µ–Ω—è–π —Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é.

### –£—Ä–æ–≤–µ–Ω—å 1: –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã (üî¥ –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø –û–°–¢–û–†–û–ñ–ù–û–°–¢–¨)

| –ú–æ–¥—É–ª—å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –†–∏—Å–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π |
|--------|------------|----------------|
| `web_server.py` | Webhook —Å–µ—Ä–≤–µ—Ä + frontend serving | –ü–æ–ª–æ–º–∫–∞ = –±–æ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω |
| `bot/database.py` | Connection pool PostgreSQL | –ü–æ–ª–æ–º–∫–∞ = –ø–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö |
| `bot/config/settings.py` | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | –ü–æ–ª–æ–º–∫–∞ = –±–æ—Ç –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç |
| `railway.json` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–µ–ø–ª–æ—è | –ü–æ–ª–æ–º–∫–∞ = —Ä–µ–¥–µ–ø–ª–æ–π —Å–ª–æ–º–∞–Ω |

### –£—Ä–æ–≤–µ–Ω—å 2: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–π (üü† –í–´–°–û–ö–ê–Ø –û–°–¢–û–†–û–ñ–ù–û–°–¢–¨)

| –ú–æ–¥—É–ª—å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –†–∏—Å–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π |
|--------|------------|----------------|
| `bot/services/moderation_service.py` | –ú–æ–¥–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ | –ü–æ–ª–æ–º–∫–∞ = –æ–ø–∞—Å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç |
| `bot/config/forbidden_patterns.py` | –ó–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (150+) | –ü–æ–ª–æ–º–∫–∞ = –æ–±—Ö–æ–¥ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ |
| `bot/services/ai_moderator.py` | AI –º–æ–¥–µ—Ä–∞—Ü–∏—è | –ü–æ–ª–æ–º–∫–∞ = –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã |
| `bot/handlers/ai_chat.py` | –¶–µ–ø–æ—á–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ | –ü–æ–ª–æ–º–∫–∞ = –º–æ–¥–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–ø—É—â–µ–Ω–∞ |

### –£—Ä–æ–≤–µ–Ω—å 3: AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (üü° –°–†–ï–î–ù–Ø–Ø –û–°–¢–û–†–û–ñ–ù–û–°–¢–¨)

| –ú–æ–¥—É–ª—å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°–∏–≥–Ω–∞—Ç—É—Ä–∞ (–ù–ï –ú–ï–ù–Ø–¢–¨) |
|--------|------------|------------------------|
| `bot/services/speech_service.py` | –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ | `transcribe_voice(voice_file_bytes: bytes, language: str = "ru")` |
| `bot/services/yandex_cloud_service.py` | Yandex AI API | –ü—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã |
| `bot/services/ai_service_solid.py` | SOLID —Ñ–∞—Å–∞–¥ AI | `generate_response()`, `analyze_image()` |
| `bot/config/prompts.py` | –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç | –í–ª–∏—è–µ—Ç –Ω–∞ –ø–æ–≤–µ–¥–µ–Ω–∏–µ AI |

## –ü–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–æ–¥—É–ª—è

### –ß–µ–∫-–ª–∏—Å—Ç

- [ ] –ü–æ–Ω–∏–º–∞—é, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –∫–æ–¥?
- [ ] –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ?
- [ ] –ï—Å—Ç—å –ª–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–¥–∞?
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ª–∏ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å?
- [ ] –ö–∞–∫ —ç—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–π?
- [ ] –ö–∞–∫ —ç—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ production uptime?

### –ü—Ä–æ—Ü–µ—Å—Å –∏–∑–º–µ–Ω–µ–Ω–∏—è

1. **–ü—Ä–æ—á–∏—Ç–∞–π –≤–µ—Å—å —Ñ–∞–π–ª** ‚Äî –Ω–µ —Ç–æ–ª—å–∫–æ –º–µ—Å—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
2. **–ù–∞–π–¥–∏ –≤—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** ‚Äî `grep -r "—Ñ—É–Ω–∫—Ü–∏—è" bot/`
3. **–ü—Ä–æ–≤–µ—Ä—å —Ç–µ—Å—Ç—ã** ‚Äî `pytest tests/ -k "test_–Ω–∞–∑–≤–∞–Ω–∏–µ" -v`
4. **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ** ‚Äî —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ
5. **–õ–æ–∫–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç** ‚Äî `python web_server.py` + –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±–æ—Ç–µ

## –ó–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

```
‚ùå –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
‚ùå –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–∏–≥–Ω–∞—Ç—É—Ä –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
‚ùå –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚ùå –•–∞—Ä–¥–∫–æ–¥ —Å–µ–∫—Ä–µ—Ç–æ–≤
‚ùå –ò–∑–º–µ–Ω–µ–Ω–∏–µ database_url –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚ùå –£–¥–∞–ª–µ–Ω–∏–µ rate limiting
‚ùå –û–±—Ö–æ–¥ Pydantic –≤–∞–ª–∏–¥–∞—Ü–∏–∏
```

## –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```
Production (Railway.app):
‚îú‚îÄ‚îÄ PostgreSQL 17 (managed)
‚îú‚îÄ‚îÄ Webhook: pandapal-bot-production.up.railway.app
‚îú‚îÄ‚îÄ Domain: pandapal.ru (Cloudflare DNS)
‚îî‚îÄ‚îÄ Variables: DATABASE_URL, TELEGRAM_BOT_TOKEN, YANDEX_*, SECRET_KEY

Yandex Cloud:
‚îú‚îÄ‚îÄ YandexGPT Lite (—á–∞—Ç)
‚îú‚îÄ‚îÄ SpeechKit STT (–≥–æ–ª–æ—Å)
‚îî‚îÄ‚îÄ Vision OCR (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
```

## –ö–∞–∫ –≤–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ

### –ù–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

```python
# ‚úÖ –°–æ–∑–¥–∞–π –ù–û–í–´–ô —Ñ–∞–π–ª/–∫–ª–∞—Å—Å
# bot/services/my_new_feature.py
class MyNewFeature:
    pass

# ‚úÖ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
# bot/handlers/__init__.py
from bot.handlers.my_feature import router as my_feature_router
routers.append(my_feature_router)
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–∞

```python
# ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø–æ–≤–µ–¥–µ–Ω–∏—è
def existing_function(param: str) -> str:
    # –ë–∞–≥: –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª—Å—è –ø—É—Å—Ç–æ–π param
    if not param:  # ‚Üê –î–æ–±–∞–≤–ª–µ–Ω–æ
        return ""  # ‚Üê –î–æ–±–∞–≤–ª–µ–Ω–æ
    return process(param)
```

### –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥

```python
# ‚ùå –ù–ï —Ä–µ—Ñ–∞–∫—Ç–æ—Ä—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–¥ "–¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã"
# ‚ùå –ù–ï –º–µ–Ω—è–π —Ä–∞–±–æ—á–∏–π –∫–æ–¥ –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø—Ä–∏—á–∏–Ω—ã
# ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
# ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–π –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
```

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

–ü—Ä–∏ –ø–æ–ª–æ–º–∫–µ production:
1. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Railway
2. –û—Ç–∫–∞—Ç–∏ –∫–æ–º–º–∏—Ç: `git revert HEAD`
3. –†–µ–¥–µ–ø–ª–æ–π: `git push origin main`
