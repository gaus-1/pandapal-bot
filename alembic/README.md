# Alembic - Миграции БД

Миграции базы данных PostgreSQL через Alembic.

## Структура

- `versions/` - файлы миграций (все изменения БД)
- `env.py` - конфигурация Alembic
- `script.py.mako` - шаблон для новых миграций

## Команды

### Создание миграции

Когда изменил модели в `bot/models.py`, создаешь миграцию:

```bash
alembic revision --autogenerate -m "описание изменений"
```

Alembic автоматически найдет изменения и создаст миграцию.

### Применение миграций

```bash
# Применить все миграции
alembic upgrade head

# Применить конкретную миграцию
alembic upgrade <revision>

# Откатить последнюю миграцию
alembic downgrade -1
```

### Просмотр истории

```bash
# Текущая версия БД
alembic current

# История всех миграций
alembic history
```

## Правила

- Каждая миграция должна быть обратимой
- Не изменяй существующие миграции после применения
- Тестируй миграции на тестовой БД перед применением
- Делай бэкап перед применением в production

## Важно

- Миграции применяются автоматически при деплое на Railway
- Всегда проверяй миграции локально перед коммитом
- При конфликтах миграций - разрешай вручную
