# Alembic - Миграции БД

Миграции базы данных PostgreSQL через Alembic.

## Структура

- `versions/` - файлы миграций
- `env.py` - конфигурация Alembic
- `script.py.mako` - шаблон для новых миграций

## Команды

### Создание миграции
```bash
alembic revision -m "описание изменений"
```

### Применение миграций
```bash
# Применить все миграции
alembic upgrade head

# Применить конкретную миграцию
alembic upgrade <revision>

# Откатить последнюю миграцию
alembic downgrade -1
```

### Просмотр истории
```bash
# Текущая версия
alembic current

# История миграций
alembic history
```

## Правила

- Каждая миграция должна быть обратимой (upgrade/downgrade)
- Не изменять существующие миграции после применения
- Тестировать миграции на тестовой БД перед применением
- Делать бэкап перед применением в production

## Важно

- Миграции применяются автоматически при деплое на Railway
- Всегда проверяй миграции локально перед коммитом
- При конфликтах миграций - разрешать вручную
