"""
–°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –ø–æ —ç–º–æ–¥–∑–∏ –≤ –æ—Ç–≤–µ—Ç–∞—Ö –ü–∞–Ω–¥—ã.

–û–¥–Ω–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å: –ø–∞—Ä—Å–∏–Ω–≥ —Ñ—Ä–∞–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞
—Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞. –ù–µ –Ω–∞—Ä—É—à–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ç–≤–µ—Ç–æ–≤ ‚Äî —ç–º–æ–¥–∑–∏ —Ç–æ–ª—å–∫–æ —É–∫—Ä–∞—à–µ–Ω–∏–µ.
"""

from typing import Literal

# –§—Ä–∞–∑—ã ¬´–Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–º–æ–¥–∑–∏¬ª (—Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏)
NO_EMOJI_PHRASES = (
    "–Ω–µ —Å—Ç–∞–≤—å —ç–º–æ–¥–∑–∏",
    "–Ω–µ —Å—Ç–∞–≤—å —Å–º–∞–π–ª–∏–∫–∏",
    "–±–µ–∑ —ç–º–æ–¥–∑–∏",
    "–±–µ–∑ —Å–º–∞–π–ª–∏–∫–æ–≤",
    "–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏",
    "–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π —Å–º–∞–π–ª–∏–∫–∏",
    "–Ω–µ –Ω–∞–¥–æ —ç–º–æ–¥–∑–∏",
    "–Ω–µ –Ω—É–∂–Ω—ã —ç–º–æ–¥–∑–∏",
    "–Ω–µ –ø–∏—à–∏ —ç–º–æ–¥–∑–∏",
    "–±–µ–∑ —ç–º–æ–¥–∂–∏",
    "–Ω–µ —ç–º–æ–¥–∑–∏",
)

# –§—Ä–∞–∑—ã ¬´–¥–æ–±–∞–≤–ª—è—Ç—å —ç–º–æ–¥–∑–∏¬ª
YES_EMOJI_PHRASES = (
    "–¥–æ–±–∞–≤–ª—è–π —ç–º–æ–¥–∑–∏",
    "—Å—Ç–∞–≤—å —ç–º–æ–¥–∑–∏",
    "—Å —ç–º–æ–¥–∑–∏",
    "–º–æ–∂–Ω–æ —ç–º–æ–¥–∑–∏",
    "—Ö–æ—á—É —ç–º–æ–¥–∑–∏",
    "—Å–æ —Å–º–∞–π–ª–∏–∫–∞–º–∏",
    "–¥–æ–±–∞–≤–ª—è–π —Å–º–∞–π–ª–∏–∫–∏",
    "—Å —ç–º–æ–¥–∂–∏",
    "–∏—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏",
)


def parse_emoji_preference_from_message(message: str) -> Literal[False, True] | None:
    """
    –ò–∑–≤–ª–µ–∫–∞–µ—Ç –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ –ø–æ —ç–º–æ–¥–∑–∏ –∏–∑ —Ç–µ–∫—Å—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

    Returns:
        False ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏—Ç –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–º–æ–¥–∑–∏.
        True ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–º–æ–¥–∑–∏.
        None ‚Äî –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –Ω–µ—Ç —è–≤–Ω–æ–π –ø—Ä–æ—Å—å–±—ã (–ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ –Ω–µ –º–µ–Ω—è—Ç—å).
    """
    if not message or not isinstance(message, str):
        return None
    lower = message.lower().strip()
    for phrase in NO_EMOJI_PHRASES:
        if phrase in lower:
            return False
    for phrase in YES_EMOJI_PHRASES:
        if phrase in lower:
            return True
    return None


def compute_allow_emoji_this_turn(chat_history: list[dict]) -> bool:  # noqa: ARG001
    """–≠–º–æ–¥–∑–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –≤ –∫–∞–∂–¥–æ–º –æ—Ç–≤–µ—Ç–µ (–µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –æ—Ç–∫–ª—é—á–∏–ª)."""
    return True


def get_emoji_prompt_snippet(
    emoji_in_chat: bool | None,
    allow_emoji_this_turn: bool,  # noqa: ARG001
) -> str | None:
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ—Ä–∞–≥–º–µ–Ω—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ –ø—Ä–æ —ç–º–æ–¥–∑–∏.

    Args:
        emoji_in_chat: None = –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (—ç–º–æ–¥–∑–∏ –≤–∫–ª—é—á–µ–Ω—ã), False = –æ—Ç–∫–ª—é—á–µ–Ω—ã, True = –≤–∫–ª—é—á–µ–Ω—ã.
        allow_emoji_this_turn: –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (–æ—Å—Ç–∞–≤–ª–µ–Ω –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏).

    Returns:
        –°—Ç—Ä–æ–∫–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç.
    """
    if emoji_in_chat is False:
        return (
            "–≠–º–æ–¥–∑–∏ –≤ –æ—Ç–≤–µ—Ç–∞—Ö –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π. "
            "–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ (–∞–±–∑–∞—Ü—ã, —Å–ø–∏—Å–∫–∏, –≤—ã–¥–µ–ª–µ–Ω–∏—è, –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞) —Å–æ–±–ª—é–¥–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–≥–æ."
        )
    # emoji_in_chat is True –∏–ª–∏ None ‚Äî —ç–º–æ–¥–∑–∏ –≤ –∫–∞–∂–¥–æ–º –æ—Ç–≤–µ—Ç–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω—ã)
    return (
        "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–±–∞–≤—å —Ä–æ–≤–Ω–æ 1‚Äì2 —É–º–µ—Å—Ç–Ω—ã—Ö —ç–º–æ–¥–∑–∏ –ø–æ —Ç–µ–º–µ –æ—Ç–≤–µ—Ç–∞. "
        "–≠–º–æ–¥–∑–∏ —Å—Ç–∞–≤—å –≤ –Ω–∞—á–∞–ª–µ –∫–ª—é—á–µ–≤–æ–≥–æ –∞–±–∑–∞—Ü–∞ –∏–ª–∏ —Ä—è–¥–æ–º —Å –æ—Å–Ω–æ–≤–Ω—ã–º —Ç–µ—Ä–º–∏–Ω–æ–º, "
        "–Ω–µ –≤ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ. –ü—Ä–∏–º–µ—Ä—ã: üßÆ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞, üìñ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞, üåø –±–∏–æ–ª–æ–≥–∏—è, "
        "üî¨ —Ñ–∏–∑–∏–∫–∞, üåç –≥–µ–æ–≥—Ä–∞—Ñ–∏—è, üé® –∏—Å–∫—É—Å—Å—Ç–≤–æ, üí° –∏–¥–µ—è, ‚úÖ –ø—Ä–∞–≤–∏–ª—å–Ω–æ. "
        "–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ (–∞–±–∑–∞—Ü—ã, —Å–ø–∏—Å–∫–∏, –≤—ã–¥–µ–ª–µ–Ω–∏—è, –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞) —Å–æ–±–ª—é–¥–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–≥–æ; "
        "—ç–º–æ–¥–∑–∏ —Ç–æ–ª—å–∫–æ –¥–æ–ø–æ–ª–Ω—è—é—Ç, –Ω–µ –∑–∞–º–µ–Ω—è—é—Ç –∏ –Ω–µ –Ω–∞—Ä—É—à–∞—é—Ç —Ä–∞–∑–±–∏–≤–∫—É –∏ –ø—É–Ω–∫—Ç—É–∞—Ü–∏—é."
    )
