"""
Модуль визуализации для геометрии.

Формулы площадей, объемов, классификация фигур, тригонометрия.
"""

from bot.services.visualization.base import BaseVisualizationService


class GeometryVisualization(BaseVisualizationService):
    """Визуализация для геометрии: формулы, классификация, тригонометрия."""

    def generate_geometry_area_formulas_table(self) -> bytes | None:
        """Генерирует таблицу формул площадей плоских фигур."""
        headers = ["Фигура", "Формула", "Обозначения"]
        rows = [
            ["Треугольник", "S = (1/2)ah", "a - основание, h - высота"],
            ["Параллелограмм", "S = ah", "a - сторона, h - высота"],
            ["Ромб", "S = (1/2)d₁d₂", "d₁, d₂ - диагонали"],
            ["Трапеция", "S = (1/2)(a+b)h", "a, b - основания, h - высота"],
            ["Круг", "S = πr²", "r - радиус"],
            ["Прямоугольник", "S = ab", "a, b - стороны"],
            ["Квадрат", "S = a²", "a - сторона"],
        ]
        return self.generate_table(headers, rows, "Формулы площадей плоских фигур")

    def generate_geometry_volume_formulas_table(self) -> bytes | None:
        """Генерирует таблицу формул объемов пространственных тел."""
        headers = ["Тело", "Формула", "Обозначения"]
        rows = [
            ["Призма", "V = Sh", "S - площадь основания, h - высота"],
            ["Пирамида", "V = (1/3)Sh", "S - площадь основания, h - высота"],
            ["Цилиндр", "V = πr²h", "r - радиус, h - высота"],
            ["Конус", "V = (1/3)πr²h", "r - радиус, h - высота"],
            ["Шар", "V = (4/3)πr³", "r - радиус"],
            ["Куб", "V = a³", "a - ребро"],
            ["Параллелепипед", "V = abc", "a, b, c - измерения"],
        ]
        return self.generate_table(headers, rows, "Формулы объемов пространственных тел")

    def generate_triangle_classification_table(self) -> bytes | None:
        """Генерирует таблицу классификации треугольников."""
        headers = ["Признак", "Вид", "Описание"]
        rows = [
            ["По сторонам", "Равносторонний", "все стороны равны"],
            ["По сторонам", "Равнобедренный", "две стороны равны"],
            ["По сторонам", "Разносторонний", "все стороны разные"],
            ["По углам", "Остроугольный", "все углы < 90°"],
            ["По углам", "Прямоугольный", "один угол = 90°"],
            ["По углам", "Тупоугольный", "один угол > 90°"],
        ]
        return self.generate_table(headers, rows, "Классификация треугольников")

    def generate_quadrilateral_classification_table(self) -> bytes | None:
        """Генерирует таблицу классификации четырехугольников."""
        headers = ["Четырехугольник", "Признаки", "Свойства"]
        rows = [
            ["Параллелограмм", "противоположные стороны параллельны", "диагонали делятся пополам"],
            ["Прямоугольник", "параллелограмм с прямыми углами", "диагонали равны"],
            ["Ромб", "параллелограмм с равными сторонами", "диагонали перпендикулярны"],
            ["Квадрат", "прямоугольник с равными сторонами", "все свойства"],
            ["Трапеция", "одна пара сторон параллельна", "средняя линия = (a+b)/2"],
        ]
        return self.generate_table(headers, rows, "Классификация четырехугольников")

    def generate_trigonometry_table(self) -> bytes | None:
        """Генерирует таблицу тригонометрических функций для стандартных углов."""
        headers = ["Угол", "sin", "cos", "tan", "cot"]
        rows = [
            ["0°", "0", "1", "0", "не определен"],
            ["30°", "1/2", "√3/2", "√3/3", "√3"],
            ["45°", "√2/2", "√2/2", "1", "1"],
            ["60°", "√3/2", "1/2", "√3", "√3/3"],
            ["90°", "1", "0", "не определен", "0"],
            ["180°", "0", "-1", "0", "не определен"],
        ]
        return self.generate_table(headers, rows, "Тригонометрические функции")
