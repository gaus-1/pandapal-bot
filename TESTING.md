# üß™ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é PandaPal

## üìã –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

### 1. **Unit —Ç–µ—Å—Ç—ã** (–±—ã—Å—Ç—Ä—ã–µ, –º–æ–∫–∏)
–ü—Ä–æ–≤–µ—Ä—è—é—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤ –∏–∑–æ–ª—è—Ü–∏–∏.
- ‚úÖ **69 passing** —Ç–µ—Å—Ç–æ–≤
- ‚ö° –ë—ã—Å—Ç—Ä—ã–µ (~10 —Å–µ–∫—É–Ω–¥)
- üí∞ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ (–±–µ–∑ API)

```bash
cd frontend
npm run test              # –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö unit —Ç–µ—Å—Ç–æ–≤
npm run test:ui           # UI –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–µ—Å—Ç–æ–≤
npm run test:coverage     # –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
```

### 2. **E2E —Ç–µ—Å—Ç—ã** (–º–µ–¥–ª–µ–Ω–Ω—ã–µ, —Ä–µ–∞–ª—å–Ω—ã–µ API)
–ü—Ä–æ–≤–µ—Ä—è—é—Ç –≤–µ—Å—å flow –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—Ç –Ω–∞—á–∞–ª–∞ –¥–æ –∫–æ–Ω—Ü–∞.
- üéØ **7 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö** —Ç–µ—Å—Ç–æ–≤
- üêå –ú–µ–¥–ª–µ–Ω–Ω—ã–µ (~60-90 —Å–µ–∫—É–Ω–¥ –Ω–∞ —Ç–µ—Å—Ç)
- üí∞ **–ò–°–ü–û–õ–¨–ó–£–Æ–¢ –†–ï–ê–õ–¨–ù–´–ï Yandex API** (—Ç—Ä–∞—Ç—è—Ç –¥–µ–Ω—å–≥–∏!)

```bash
cd frontend
npx playwright install chromium  # –ü–µ—Ä–≤—ã–π —Ä–∞–∑ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±—Ä–∞—É–∑–µ—Ä

npm run test:e2e                 # –ó–∞–ø—É—Å–∫ E2E —Ç–µ—Å—Ç–æ–≤ (headless)
npm run test:e2e:headed          # –° –æ—Ç–∫—Ä—ã—Ç—ã–º –±—Ä–∞—É–∑–µ—Ä–æ–º
npm run test:e2e:ui              # UI –¥–ª—è E2E —Ç–µ—Å—Ç–æ–≤
npm run test:e2e:debug           # –û—Ç–ª–∞–¥–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
npm run test:e2e:report          # –ü–æ–∫–∞–∑–∞—Ç—å HTML —Ä–µ–ø–æ—Ä—Ç
```

### 3. **Backend Integration —Ç–µ—Å—Ç—ã** (Python, —Ä–µ–∞–ª—å–Ω—ã–µ API)
–ü—Ä–æ–≤–µ—Ä—è—é—Ç —á—Ç–æ backend —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Yandex API –±–µ–∑ –º–æ–∫–æ–≤.
- üî¥ **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–µ—Ç–µ–π
- üí∞ **–ò–°–ü–û–õ–¨–ó–£–Æ–¢ –†–ï–ê–õ–¨–ù–´–ï API** (—Ç—Ä–∞—Ç—è—Ç –¥–µ–Ω—å–≥–∏!)

```bash
# –ò–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
pytest tests/integration/test_yandex_api_real.py -v --tb=short

# –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
pytest tests/integration/test_yandex_api_real.py::TestYandexAPIReal::test_yandex_gpt_text_response_real -v
```

---

## üéØ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï E2E –¢–ï–°–¢–´ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º!)

### ‚úÖ –¢–µ—Å—Ç 1: AI –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ Yandex GPT
```bash
npm run test:e2e -- miniapp.critical.spec.ts -g "AI –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –†–ï–ê–õ–¨–ù–´–ô —Ç–µ–∫—Å—Ç"
```
**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- Mini App –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- –ü–æ–ª–µ –≤–≤–æ–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–æ
- –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è
- YandexGPT –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –†–ï–ê–õ–¨–ù–´–ô –æ—Ç–≤–µ—Ç
- –û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (x = 4)

**–í—Ä–µ–º—è:** ~45 —Å–µ–∫—É–Ω–¥
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** ~‚ÇΩ0.10

---

### ‚úÖ –¢–µ—Å—Ç 2: AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ñ–æ—Ç–æ —á–µ—Ä–µ–∑ Yandex Vision
```bash
npm run test:e2e -- miniapp.critical.spec.ts -g "AI –¥–æ–ª–∂–µ–Ω –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –†–ï–ê–õ–¨–ù–û–ï —Ñ–æ—Ç–æ"
```
**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ backend
- Yandex Vision OCR —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç —Ç–µ–∫—Å—Ç/–æ–±—ä–µ–∫—Ç—ã
- YandexGPT –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç Vision
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç

**–í—Ä–µ–º—è:** ~60 —Å–µ–∫—É–Ω–¥
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** ~‚ÇΩ0.30

---

### ‚úÖ –¢–µ—Å—Ç 3: AI —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –∞—É–¥–∏–æ —á–µ—Ä–µ–∑ Yandex SpeechKit
```bash
npm run test:e2e -- miniapp.critical.spec.ts -g "AI –¥–æ–ª–∂–µ–Ω —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –†–ï–ê–õ–¨–ù–û–ï –∞—É–¥–∏–æ"
```
**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- –ö–Ω–æ–ø–∫–∞ –∑–∞–ø–∏—Å–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- MediaRecorder API –¥–æ—Å—Ç—É–ø–µ–Ω
- –ê—É–¥–∏–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ backend
- Yandex SpeechKit —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç —Ä–µ—á—å
- YandexGPT –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç

**‚ö†Ô∏è –ü–†–ò–ú–ï–ß–ê–ù–ò–ï:** –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç —Ç—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞.

**–í—Ä–µ–º—è:** ~60 —Å–µ–∫—É–Ω–¥
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** ~‚ÇΩ0.20

---

### ‚úÖ –¢–µ—Å—Ç 4: Emergency –Ω–æ–º–µ—Ä–∞ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã
```bash
npm run test:e2e -- miniapp.critical.spec.ts -g "Emergency –Ω–æ–º–µ—Ä–∞"
```
**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- –ö–Ω–æ–ø–∫–∞ SOS —Ä–∞–±–æ—Ç–∞–µ—Ç
- –≠–∫—Ä–∞–Ω Emergency –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- –ù–æ–º–µ—Ä 112 –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- tel: —Å—Å—ã–ª–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è

**–í—Ä–µ–º—è:** ~5 —Å–µ–∫—É–Ω–¥
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** ‚ÇΩ0 (–±–µ–∑ API)

---

### ‚úÖ –¢–µ—Å—Ç 5: –ù–∞–≤–∏–≥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
```bash
npm run test:e2e -- miniapp.critical.spec.ts -g "–ù–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏"
```
**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- –ü–µ—Ä–µ—Ö–æ–¥ AI Chat ‚Üî Emergency
- –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- UI –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–í—Ä–µ–º—è:** ~5 —Å–µ–∫—É–Ω–¥
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** ‚ÇΩ0 (–±–µ–∑ API)

---

## üí∞ –°–¢–û–ò–ú–û–°–¢–¨ –¢–ï–°–¢–û–í

### Unit —Ç–µ—Å—Ç—ã (69 —Ç–µ—Å—Ç–æ–≤):
- **–°—Ç–æ–∏–º–æ—Å—Ç—å:** ‚ÇΩ0 (–∏—Å–ø–æ–ª—å–∑—É—é—Ç –º–æ–∫–∏)
- **–ó–∞–ø—É—Å–∫–∞—Ç—å:** –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∫–æ–º–º–∏—Ç–µ

### E2E —Ç–µ—Å—Ç—ã (7 —Ç–µ—Å—Ç–æ–≤):
- **–°—Ç–æ–∏–º–æ—Å—Ç—å:** ~‚ÇΩ1.00 –∑–∞ –ø–æ–ª–Ω—ã–π –ø—Ä–æ–≥–æ–Ω
  - YandexGPT: ‚ÇΩ0.30 (3 —Ç–µ—Å—Ç–∞ √ó ‚ÇΩ0.10)
  - Vision OCR: ‚ÇΩ0.30 (1 —Ç–µ—Å—Ç)
  - SpeechKit: ‚ÇΩ0.20 (1 —Ç–µ—Å—Ç)
  - –û—Å—Ç–∞–ª—å–Ω—ã–µ: ‚ÇΩ0 (–±–µ–∑ API)

- **–ó–∞–ø—É—Å–∫–∞—Ç—å:**
  - ‚ùå –ù–ï –≤ CI/CD (–¥–æ—Ä–æ–≥–æ!)
  - ‚úÖ –í—Ä—É—á–Ω—É—é –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
  - ‚úÖ –ü–æ—Å–ª–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π AI

### Backend Integration (4 —Ç–µ—Å—Ç–∞):
- **–°—Ç–æ–∏–º–æ—Å—Ç—å:** ~‚ÇΩ0.50 –∑–∞ –ø—Ä–æ–≥–æ–Ω
- **–ó–∞–ø—É—Å–∫–∞—Ç—å:** –ü–µ—Ä–µ–¥ production –¥–µ–ø–ª–æ–µ–º

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π workflow

### –ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å):
```bash
npm run test              # Unit —Ç–µ—Å—Ç—ã (–±—ã—Å—Ç—Ä–æ, –±–µ—Å–ø–ª–∞—Ç–Ω–æ)
```

### –ü–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º:
```bash
npm run test              # –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ unit —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
npm run lint              # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ style
```

### –ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º –≤ production:
```bash
# 1. Unit —Ç–µ—Å—Ç—ã
npm run test

# 2. –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï E2E —Ç–µ—Å—Ç—ã (–≤—ã–±–æ—Ä–æ—á–Ω–æ!)
npm run test:e2e -- miniapp.critical.spec.ts -g "AI –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –†–ï–ê–õ–¨–ù–´–ô —Ç–µ–∫—Å—Ç"
npm run test:e2e -- miniapp.critical.spec.ts -g "Emergency –Ω–æ–º–µ—Ä–∞"

# 3. Backend integration (–µ—Å–ª–∏ –º–µ–Ω—è–ª–∏ AI logic)
pytest tests/integration/test_yandex_api_real.py::TestYandexAPIReal::test_yandex_gpt_text_response_real -v

# 4. –î–µ–ø–ª–æ–π!
git push origin main
```

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

### 1. **–ù–ï –∑–∞–ø—É—Å–∫–∞—Ç—å E2E –≤ CI/CD**
E2E —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ Yandex API –∏ —Ç—Ä–∞—Ç—è—Ç –¥–µ–Ω—å–≥–∏.
–ó–∞–ø—É—Å–∫–∞—Ç—å –∏—Ö –Ω–∞ –∫–∞–∂–¥—ã–π commit = –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ! üí∏

### 2. **E2E —Ç–µ—Å—Ç—ã —Ç—Ä–µ–±—É—é—Ç production URL**
–¢–µ—Å—Ç—ã —Ö–æ–¥—è—Ç –Ω–∞ `https://pandapal.ru` (production).
–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ unit —Ç–µ—Å—Ç—ã.

### 3. **–ê—É–¥–∏–æ —Ç–µ—Å—Ç—ã –Ω–µ–ø–æ–ª–Ω—ã–µ**
–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç –∞—É–¥–∏–æ —Ç—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞.
–í –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö E2E –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ UI.

### 4. **Backend —Ç–µ—Å—Ç—ã —Ç—Ä–µ–±—É—é—Ç env**
Integration —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ API –∫–ª—é—á–∏ –∏–∑ `.env`:
```bash
YANDEX_CLOUD_API_KEY=xxx
YANDEX_CLOUD_FOLDER_ID=yyy
```

---

## üìä –¢–ï–ö–£–©–ï–ï –ü–û–ö–†–´–¢–ò–ï

```
Unit Tests:        69/78 passing (88%)
E2E Tests:         7 critical scenarios
Integration:       4 backend tests

–†–ï–ê–õ–¨–ù–´–ï API:      ‚úÖ –ë–ï–ó –ú–û–ö–û–í
  - YandexGPT:     ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω
  - Vision OCR:    ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω
  - SpeechKit:     ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω

–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨:      ‚úÖ –ú–æ–¥–µ—Ä–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞
                   ‚úÖ Emergency –Ω–æ–º–µ—Ä–∞ —Ä–∞–±–æ—Ç–∞—é—Ç
```

---

## üêõ –û—Ç–ª–∞–¥–∫–∞ —Ç–µ—Å—Ç–æ–≤

### Unit —Ç–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç:
```bash
npm run test:ui          # –û—Ç–∫—Ä–æ–µ—Ç Vitest UI
# –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ –ø–∞–¥–∞—é—â–∏–π —Ç–µ—Å—Ç –¥–ª—è –¥–µ—Ç–∞–ª–µ–π
```

### E2E —Ç–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç:
```bash
npm run test:e2e:headed  # –£–≤–∏–¥–∏—à—å —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ
npm run test:e2e:debug   # –ü–æ—à–∞–≥–æ–≤–∞—è –æ—Ç–ª–∞–¥–∫–∞
```

### Backend —Ç–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç:
```bash
pytest tests/integration/test_yandex_api_real.py -v --tb=long --log-cli-level=DEBUG
```

---

## üéì –î–õ–Ø –î–ï–¢–ï–ô - –ì–õ–ê–í–ù–û–ï:

‚úÖ **Unit —Ç–µ—Å—Ç—ã** - –∑–∞—â–∏—â–∞—é—Ç –æ—Ç —Å–ª—É—á–∞–π–Ω—ã—Ö –ø–æ–ª–æ–º–æ–∫ –∫–æ–¥–∞
‚úÖ **E2E —Ç–µ—Å—Ç—ã** - –ø—Ä–æ–≤–µ—Ä—è—é—Ç —á—Ç–æ AI –†–ï–ê–õ–¨–ù–û —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úÖ **–ë–µ–∑ –º–æ–∫–æ–≤** - –Ω–∏–∫–∞–∫–∏—Ö –∑–∞–≥–ª—É—à–µ–∫, —Ç–æ–ª—å–∫–æ –Ω–∞—Å—Ç–æ—è—â–∏–µ API
‚úÖ **Emergency —Ç–µ—Å—Ç—ã** - –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–µ–≤—ã—à–µ –≤—Å–µ–≥–æ!

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–µ—Ç–∏ –ø–æ–ª—É—á–∞—é—Ç –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —à–≤–µ–π—Ü–∞—Ä—Å–∫–∏–µ —á–∞—Å—ã! üêº‚öôÔ∏è
