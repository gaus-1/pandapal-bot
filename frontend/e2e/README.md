# E2E тесты для PandaPal Mini App

## Важно

Эти тесты используют реальные Yandex API и тратят реальные деньги.

### Не запускать
- В CI/CD pipeline
- При каждом коммите
- Для локальной отладки (используйте unit тесты)

### Запускать
- Перед production деплоем (вручную)
- После изменений в AI логике
- Для проверки критических функций

## Стоимость

- Полный прогон (7 тестов): ~1.00 руб
- Один тест с API: ~0.10-0.30 руб

## Быстрый старт

### Установить браузер

```bash
npx playwright install chromium
```

### Запустить критический тест

```bash
npm run test:e2e -- miniapp.critical.spec.ts -g "AI должен отвечать на РЕАЛЬНЫЙ текст"
```

### Запустить все E2E тесты

```bash
npm run test:e2e
```

## Тесты

1. AI текст (YandexGPT) - проверяет решение уравнения, ~0.10 руб, ~45 сек
2. AI фото (Yandex Vision + GPT) - анализ изображения, ~0.30 руб, ~60 сек
3. AI аудио (SpeechKit + GPT) - распознавание голоса, ~0.20 руб, ~60 сек
4. Emergency номера - проверка кликабельности 112, бесплатно, ~5 сек
5. Навигация - переходы между экранами, бесплатно, ~5 сек
6. История чата - сохранение сообщений, ~0.10 руб, ~60 сек
7. Error handling - обработка ошибок, бесплатно, ~10 сек

## Отладка

### Видеть что происходит в браузере

```bash
npm run test:e2e:headed
```

### Пошаговая отладка

```bash
npm run test:e2e:debug
```

### Посмотреть HTML репорт

```bash
npm run test:e2e:report
```

## Результат

После запуска:
- Скриншоты при ошибках в `test-results/`
- HTML репорт в `playwright-report/`
- Видео при ошибках в `test-results/`
